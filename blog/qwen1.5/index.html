<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Introducing Qwen1.5 | Qwen</title><meta name=keywords content><meta name=description content="GITHUB HUGGING FACE MODELSCOPE DEMO DISCORD
Introduction In recent months, our focus has been on developing a &ldquo;good&rdquo; model while optimizing the developer experience. As we progress towards Qwen1.5, the next iteration in our Qwen series, this update arrives just before the Chinese New Year.
With Qwen1.5, we are open-sourcing base and chat models across six sizes: 0.5B, 1.8B, 4B, 7B, 14B, 32B, 72B, and 110B, and also an MoE model (see blog for more information)."><meta name=author content="Qwen Team"><link rel=canonical href=https://qwenlm.github.io/blog/qwen1.5/><link crossorigin=anonymous href=/assets/css/stylesheet.012512d6f1d6f320d85cff7ae2b89d136cc19960a4aa00adf35aaae57e557162.css integrity="sha256-ASUS1vHW8yDYXP964ridE2zBmWCkqgCt81qq5X5VcWI=" rel="preload stylesheet" as=style><link rel=icon href=https://qwenlm.github.io/favicon.png><link rel=apple-touch-icon href=https://qwenlm.github.io/favicon.png><link rel=manifest href=https://qwenlm.github.io/site.webmanifest><meta name=theme-color content="#615CED"><link rel=alternate hreflang=en href=https://qwenlm.github.io/blog/qwen1.5/><link rel=alternate hreflang=zh href=https://qwenlm.github.io/zh/blog/qwen1.5/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script defer crossorigin=anonymous src=/js/custom.df2a5734071a3a99040f5e88e6d16d78358fbdef9a5e7389874ac5f2aa2ca86f.js integrity="sha256-3ypXNAcaOpkED16I5tFteDWPve+aXnOJh0rF8qosqG8="></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css integrity=sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js integrity=sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NMEMBZ8R90"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NMEMBZ8R90",{anonymize_ip:!1})}</script><meta property="og:title" content="Introducing Qwen1.5"><meta property="og:description" content="GITHUB HUGGING FACE MODELSCOPE DEMO DISCORD
Introduction In recent months, our focus has been on developing a &ldquo;good&rdquo; model while optimizing the developer experience. As we progress towards Qwen1.5, the next iteration in our Qwen series, this update arrives just before the Chinese New Year.
With Qwen1.5, we are open-sourcing base and chat models across six sizes: 0.5B, 1.8B, 4B, 7B, 14B, 32B, 72B, and 110B, and also an MoE model (see blog for more information)."><meta property="og:type" content="article"><meta property="og:url" content="https://qwenlm.github.io/blog/qwen1.5/"><meta property="og:image" content="https://qwenlm.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-02-04T13:33:00+08:00"><meta property="article:modified_time" content="2024-02-04T13:33:00+08:00"><meta property="og:site_name" content="Qwen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://qwenlm.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Introducing Qwen1.5"><meta name=twitter:description content="GITHUB HUGGING FACE MODELSCOPE DEMO DISCORD
Introduction In recent months, our focus has been on developing a &ldquo;good&rdquo; model while optimizing the developer experience. As we progress towards Qwen1.5, the next iteration in our Qwen series, this update arrives just before the Chinese New Year.
With Qwen1.5, we are open-sourcing base and chat models across six sizes: 0.5B, 1.8B, 4B, 7B, 14B, 32B, 72B, and 110B, and also an MoE model (see blog for more information)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://qwenlm.github.io/blog/"},{"@type":"ListItem","position":2,"name":"Introducing Qwen1.5","item":"https://qwenlm.github.io/blog/qwen1.5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introducing Qwen1.5","name":"Introducing Qwen1.5","description":"GITHUB HUGGING FACE MODELSCOPE DEMO DISCORD\nIntroduction In recent months, our focus has been on developing a \u0026ldquo;good\u0026rdquo; model while optimizing the developer experience. As we progress towards Qwen1.5, the next iteration in our Qwen series, this update arrives just before the Chinese New Year.\nWith Qwen1.5, we are open-sourcing base and chat models across six sizes: 0.5B, 1.8B, 4B, 7B, 14B, 32B, 72B, and 110B, and also an MoE model (see blog for more information).","keywords":[],"articleBody":"GITHUB HUGGING FACE MODELSCOPE DEMO DISCORD\nIntroduction In recent months, our focus has been on developing a “good” model while optimizing the developer experience. As we progress towards Qwen1.5, the next iteration in our Qwen series, this update arrives just before the Chinese New Year.\nWith Qwen1.5, we are open-sourcing base and chat models across six sizes: 0.5B, 1.8B, 4B, 7B, 14B, 32B, 72B, and 110B, and also an MoE model (see blog for more information). In line with tradition, we’re also providing quantized models, including Int4 and Int8 GPTQ models, as well as AWQ and GGUF quantized models. To enhance the developer experience, we’ve merged Qwen1.5’s code into Hugging Face transformers, making it accessible with transformers\u003e=4.37.0 without needing trust_remote_code.\nWe’ve collaborated with frameworks like vLLM, SGLang for deployment, AutoAWQ, AutoGPTQ for quantization, Axolotl, LLaMA-Factory for finetuning, and llama.cpp for local LLM inference, all of which now support Qwen1.5. The Qwen1.5 series is available on platforms such as Ollama and LMStudio. Additionally, API services are offered not only on DashScope but also on together.ai, with global accessibility. Visit here to get started, and we recommend trying out Qwen1.5-72B-chat.\nThis release brings substantial improvements to the alignment of chat models with human preferences and enhanced multilingual capabilities. All models now uniformly support a context length of up to 32768 tokens. There have also been minor improvements in the quality of base language models that may benefit your finetuning endeavors. This step represents a small stride toward our objective of creating a truly “good” model.\nPerformance To provide a better understanding of the performance of Qwen1.5, we have conducted a comprehensive evaluation of both base and chat models on different capabilities, including basic capabilities such as language understanding, coding, reasoning, multilingual capabilities, human preference, agent, retrieval-augmented generation (RAG), etc.\nBasic Capabilities To assess the basic capabilities of language models, we have conducted evaluations on traditional benchmarks, including MMLU (5-shot), C-Eval, Humaneval, GS8K, BBH, etc.\nModel MMLU C-Eval GSM8K MATH HumanEval MBPP BBH CMMLU GPT-4 86.4 69.9 92.0 45.8 67.0 61.8 86.7 71.0 Llama2-7B 46.8 32.5 16.7 3.3 12.8 20.8 38.2 31.8 Llama2-13B 55.0 41.4 29.6 5.0 18.9 30.3 45.6 38.4 Llama2-34B 62.6 - 42.2 6.2 22.6 33.0 44.1 - Llama2-70B 69.8 50.1 54.4 10.6 23.7 37.7 58.4 53.6 Mistral-7B 64.1 47.4 47.5 11.3 27.4 38.6 56.7 44.7 Mixtral-8x7B 70.6 - 74.4 28.4 40.2 60.7 - - Qwen1.5-7B 61.0 74.1 62.5 20.3 36.0 37.4 40.2 73.1 Qwen1.5-14B 67.6 78.7 70.1 29.2 37.8 44.0 53.7 77.6 Qwen1.5-32B 73.4 83.5 77.4 36.1 37.2 49.4 66.8 82.3 Qwen1.5-72B 77.5 84.1 79.5 34.1 41.5 53.4 65.5 83.5 At every model size, Qwen1.5 demonstrates strong performance across the diverse evaluation benchmarks. In particular, Qwen1.5-72B outperforms Llama2-70B across all benchmarks, showcasing its exceptional capabilities in language understanding, reasoning, and math.\nIn light of the recent surge in interest for small language models, we have compared Qwen1.5 with sizes smaller than 7 billion parameters, against the most outstanding small-scale models within the community. The results are shown below:\nModel Non-Emb Params MMLU C-Eval GSM8K MATH HumanEval MBPP BBH CMMLU Tinyllama-1.1B 1.1B 24.3 25.0 2.3 0.7 6.7 19.9 28.8 24.0 Gemini-Nano-3B - - - 22.8 - - 27.2 42.4 - StableLM-Zephyr-3B 2.7B 45.9 30.3 52.5 12.5 35.4 31.9 37.7 30.9 Phi-2 2.5B 52.7 23.4 57.2 3.5 47.6 55.0 43.4 24.2 MiniCPM-2B 2.4B 53.5 51.1 53.8 10.2 50.0 47.3 36.9 51.1 Gemma-2B 2.0B 42.3 - 17.7 11.8 22.0 29.2 35.2 - Qwen1.5-0.5B 0.3B 39.2 50.5 22.0 3.1 12.2 6.8 18.3 46.6 Qwen1.5-1.8B 1.2B 46.8 59.7 38.4 10.1 20.1 18.0 24.2 57.8 Qwen1.5-4B 3.1B 56.1 67.6 57.0 10.0 25.6 29.2 32.5 66.7 Qwen1.5-MoE-A2.7B 2.0B 62.5 79.2 61.5 21.9 34.2 36.6 39.1 79.2 We can confidently assert that Qwen1.5 base models under 7 billion parameters are highly competitive with the leading small-scale models in the community. In the future, we will continue to improve the quality of small models and exploring methods for effectively transferring the advanced capabilities inherent in larger models into the smaller ones.\nAligning with Human Preference Alignment aims to enhance instruction-following capabilities of LLMs and help provide responses that are closely aligned with human preferences. Recognizing the significance of integrating human preferences into the learning process, we effectively employed techniques such as Direct Policy Optimization (DPO) and Proximal Policy Optimization (PPO) in aligning the latest Qwen series.\nHowever, assessing the quality of such chat models poses a significant challenge. Admittedly, while comprehensive human evaluation is the optimal approach, it faces significant challenges pertaining to scalability and reproducibility. Therefore, we initially evaluate our models on two widely-used benchmarks, utilizing advanced LLMs as judges: MT-Bench and Alpaca-Eval. The results are presented below:\nWe notice there are non-negligible variance in the scores on MT-Bench. So we have three runs with different seeds in our results and we report the average score with standard deviation.\nModels MT-Bench AlpacaEval 2.0 Avg. ScoreWin RateLength Qwen1.5-72B-Chat 8.610.04 (8.67/8.61/8.56) 27.181.30 1600 Qwen1.5-14B-Chat 7.910.11 (7.99/7.99/7.77) 19.71.12 1608 Qwen1.5-7B-Chat 7.600.05 (7.58/7.55/7.66) 13.201.43 1606 Despite still significantly trailing behind GPT-4-Turbo, the largest open-source Qwen1.5 model, Qwen1.5-72B-Chat, exhibits superior performance, surpassing Claude-2.1, GPT-3.5-Turbo-0613, Mixtral-8x7b-instruct, and TULU 2 DPO 70B, being on par with Mistral Medium, on both MT-Bench and Alpaca-Eval v2.\nFurthermore, although the scoring of LLM Judges may seemingly correlate with the lengths of responses, our observations indicate that our models do not generate lengthy responses to manipulate the bias of LLM judges. The average length of Qwen1.5-Chat on AlpacaEval 2.0 is only 1618, which aligns with the length of GPT-4 and is shorter than that of GPT-4-Turbo. Additionally, our experiments with our web service and app also reveal that users prefer the majority of responses from the new chat models.\nMultilingual Understanding of Base Models We have carefully selected a diverse set of 12 languages from Europe, East Asia, and Southeast Asia to thoroughly evaluate the multilingual capabilities of our foundational model. In order to accomplish this, we have curated test sets from the community’s open-source repositories, covering four distinct dimensions: Exams, Understanding, Translation, and Math. The table below provides detailed information about each test set, including evaluation settings, metrics, and the languages they encompass:\nDataset Category Method/Metric Languages MMLU-multi Exams 5-shot/Acc ar, es, fr, pt, de, it, ru, ja, ko, id M3Exams Exams 5-shot/Acc pt, it, vi, th BELEBELE Understanding 5-shot/Acc ar, es, fr, pt, de, it, ru, ja, ko, vi, th, id XWinograd Understanding 5-shot/Acc fr, pt, ru, ja XCOPA Understanding 5-shot/Acc vi, id, th PAWS-X Understanding 5-shot/Acc es, fr, de, ja, ko XStoryCloze Understanding 0-shot/Acc ar, es, ru, id Flores(zh/en↔xx) Translation 5-shot/BLEU ar, es, fr, pt, de, it, ru, ja, ko, vi, th, id MGSM Math 8-shot/Acc es, fr, ru, de, ja, th The detailed results are demonstrated below:\nModels Exams Understanding Math Translation GPT-3.5 52.24 71.84 32.80 31.85 GPT-4 71.64 83.82 80.13 34.37 Llama2-7B 34.03 50.13 9.40 22.19 Llama2-13B 39.55 57.26 16.80 25.89 Llama2-70B 55.88 73.19 40.20 31.56 Mistral-7B 47.12 63.30 26.33 23.33 Mixtral-8x7B 56.08 70.70 45.00 29.78 Qwen1.5-0.5B 26.98 44.08 3.13 9.17 Qwen1.5-1.8B 33.57 48.37 6.47 16.19 Qwen1.5-4B 41.43 59.76 21.33 23.34 Qwen1.5-MoE-A2.7B 44.54 61.08 30.20 27.35 Qwen1.5-7B 47.70 67.63 37.27 28.36 Qwen1.5-14B 55.72 74.10 49.93 31.69 Qwen1.5-72B 66.35 78.16 61.67 35.57 The base models of Qwen1.5 showcase impressive multilingual capabilities, as demonstrated by its performance across a diverse set of 12 languages. In evaluations covering various dimensions such as exams, understanding, translation, and math, Qwen1.5 consistently delivers strong results. From languages like Arabic, Spanish, and French to Japanese, Korean, and Thai, Qwen1.5 demonstrates its ability to comprehend and generate high-quality content across different linguistic contexts. We compared Qwen1.5-72B-Chat with GPT-3.5, and the results are shown below:\nThese results demonstrate the strong multilingual capabilities of Qwen1.5 chat models, which can serve downstream applications, such as translation, language understanding, and multilingual chat. Also, we believe that the improvements in multilingual capabilities can also level up the general capabilities.\nSupport of Long Context With the increasing demand for long-context understanding, we have expanded the capability of all models to support contexts up to 32K tokens. We have evaluated the performance of Qwen1.5 models on the L-Eval benchmark, which measures the ability of models to generate responses based on long context. The results are shown below:\nModels Coursera GSM QuALITY TOEFL SFiction Avg. GPT3.5-turbo-16k 63.51 84.00 61.38 78.43 64.84 70.43 Claude1.3-100k 60.03 88.00 73.76 83.64 72.65 75.62 GPT4-32k 75.58 96.00 82.17 84.38 74.99 82.62 Qwen-72B-Chat 58.13 76.00 77.22 86.24 69.53 73.42 Qwen1.5-0.5B-Chat 30.81 6.00 34.16 40.52 49.22 32.14 Qwen1.5-1.8B-Chat 39.24 37.00 42.08 55.76 44.53 43.72 Qwen1.5-4B-Chat 54.94 47.00 57.92 69.15 56.25 57.05 Qwen1.5-7B-Chat 59.74 60.00 64.36 79.18 62.50 65.16 Qwen1.5-14B-Chat 69.04 79.00 74.75 83.64 75.78 76.44 Qwen1.5-72B-Chat 71.95 82.00 77.72 85.50 73.44 78.12 In terms of the performance, even a small model like Qwen1.5-7B-Chat demonstrates competitive performance against GPT-3.5 on 4 out of 5 tasks. Our best model, Qwen1.5-72B-Chat, significantly outperforms GPT3.5-turbo-16k and only slightly falls behind GPT4-32k. These results highlight our outstanding performance within 32K tokens, yet they do not imply that our models are limited to supporting only 32K tokens. You can modify max_position_embedding and sliding_window in config.json to a larger value to see if the model performance is still satisfactory for your tasks.\nCapabilities to Connect with External Systems Large language models (LLMs) are popular in part due to their ability to integrate external knowledge and tools. Retrieval-Augmented Generation (RAG) has gained traction as it mitigates common LLM issues like hallucination, real-time data shortage, and private information handling. Additionally, strong LLMs typically excel at using APIs and tools via function calling, making them ideal for serving as AI agents.\nWe first assess the performance of Qwen1.5-Chat on RGB, an RAG benchmark for which we have not performed any specific optimization:\nRGB English Benchmark for Retrieval-Augmented Generation Models Noise 0.8 (Acc.↑) Rejection 1.0 (Acc.↑) Integration 0.4 (Acc.↑) Counterfactual (Acc.↑) GPT4-Turbo 85.67 47.33 60.00 90.00 GPT3.5-Turbo 74.33 27.67 47.00 21.00 Llama2-70B-Chat 82.00 31.00 56.00 15.00 Mistral-7B-Instruct-v0.2 82.00 31.00 56.00 15.00 Mixtral-8x7B-Instruct-v0.1 82.67 37.00 67.00 8.00 Qwen1.5-7B-Chat 77.67 25.00 52.00 9.00 Qwen1.5-14B-Chat 80.67 24.00 60.00 8.00 Qwen1.5-72B-Chat 81.67 48.67 61.00 28.00 RGB Chinese Benchmark for Retrieval-Augmented Generation Models Noise 0.8 (Acc.↑) Rejection 1.0 (Acc.↑) Integration 0.4 (Acc.↑) Counterfactual (Acc.↑) GPT4-Turbo 75.00 38.67 63.00 90.00 GPT3.5-Turbo 69.00 13.00 55.00 25.00 Llama2-70B-Chat 28.00 17.00 32.00 8.00 Mistral-7B-Instruct-v0.2 54.67 28.67 37.00 4.00 Mixtral-8x7B-Instruct-v0.1 27.33 4.00 24.00 4.00 Qwen1.5-7B-Chat 71.00 10.33 54.00 20.00 Qwen1.5-14B-Chat 75.00 16.67 55.00 22.00 Qwen1.5-72B-Chat 76.00 51.00 66.00 44.00 We then assess Qwen’s capacity to function as a general-purpose agent by testing it on the T-Eval benchmark. None of the Qwen models have undergone any optimization tailored specifically for this benchmark:\nAgent Performance on T-Eval English Models Overall Instruct Plan Reason Retrieve Understand Review GPT4-Turbo 86.4 96.3 87.8 65.3 88.9 85.8 94.5 Llama-2-70B-Chat 58.59 77.80 63.75 39.07 51.35 50.34 69.20 Mistral-7B-Instruct-v0.2 46.68 63.57 60.88 32.59 17.58 38.08 67.35 Mixtral-8x7B-Instruct-v0.1 62.15 42.39 46.48 60.35 76.69 73.70 73.31 Qwen1.5-7B-Chat 59.67 71.12 62.95 37.60 61.17 53.75 71.46 Qwen1.5-14B-Chat 71.77 86.16 73.09 49.51 72.07 66.03 83.78 Qwen1.5-72B-Chat 76.69 80.96 83.12 56.89 80.17 76.68 82.34 Agent Performance on T-Eval Chinese Models Overall Instruct Plan Reason Retrieve Understand Review GPT4-Turbo 85.9 97.6 87.0 68.4 89.2 86.8 86.0 Llama-2-70B-Chat 51.15 53.78 56.65 34.27 48.24 50.49 63.45 Mistral-7B-Instruct-v0.2 46.26 49.64 61.82 36.17 20.26 47.25 62.42 Mixtral-8x7B-Instruct-v0.1 62.77 26.38 60.79 62.02 76.60 77.74 73.10 Qwen1.5-7B-Chat 53.15 60.56 62.31 42.07 55.28 55.76 42.92 Qwen1.5-14B-Chat 64.85 84.25 64.77 54.68 72.35 68.88 44.15 Qwen1.5-72B-Chat 72.88 97.50 80.83 58.11 76.14 71.94 52.77 To test the capabilities of tool using, also known as function calling, we follow our previous practice and use our opensourced evaluation benchmark for assessing the models’ ability to appropriately select and use tools:\nTool-Use Benchmark ModelsTool Selection (Acc.↑)Tool Input (Rouge-L↑)False Positive (Acc.↑) GPT-4 98.0 95.3 76.1 GPT-3.5 74.5 80.7 19.4 Llama-2-70B-Chat 88.54 70.36 0.37 Mistral-7B-Instruct-v0.2 94.79 82.81 6.34 Mixtral-8x7B-Instruct-v0.1 99.31 94.46 31.34 Qwen1.5-7B-Chat 95.83 89.48 92.54 Qwen1.5-14B-Chat 93.06 88.74 92.91 Qwen1.5-72B-Chat 95.14 91.14 98.51 Finally, since the Python code interpreter has emerged as an increasingly powerful tool for advanced LLMs, we also evaluate our models’ capability in utilizing this tool on our previously open-sourced benchmark:\nCode Interpreter Benchmark Models Accuracy of Code Execution Results (%) Executable Rate of Code (%) Math↑Visualization-Hard↑Visualization-Easy↑General↑ GPT-4 82.8 66.7 60.8 82.8 GPT-3.5 47.3 33.3 55.7 74.1 Mistral-7B-Instruct-v0.2 25.5 19.1 44.3 62.1 Mixtral-8x7B-Instruct-v0.1 47.8 33.3 54.4 60.3 Qwen1.5-7B-Chat 54.0 35.7 36.7 65.5 Qwen1.5-14B-Chat 62.1 46.4 48.1 70.6 Qwen1.5-72B-Chat 73.1 52.3 50.6 87.9 Larger Qwen1.5-Chat models generally outperform smaller ones, nearing GPT-4’s tool-use performance. However, in code interpreter tasks like math problem-solving and visualization, even the largest Qwen1.5-72B-Chat model lags significantly behind GPT-4 due to coding capabilities. We aim in future versions to enhance the coding capabilities of all Qwen models during both pre-training and alignment.\nDevelop with Qwen1.5 The biggest difference in Qwen1.5 is the integration of Qwen1.5 to Hugging Face transformers. Since 4.37.0, you can use Qwen1.5 without our custom code, which means that you can load the model like the following:\nfrom transformers import AutoModelForCausalLM # This is what we previously used model = AutoModelForCausalLM.from_pretrained(\"Qwen/Qwen-7B-Chat\", device_map=\"auto\", trust_remote_code=True) # This is what you can use now model = AutoModelForCausalLM.from_pretrained(\"Qwen/Qwen1.5-7B-Chat\", device_map=\"auto\") The usage of Qwen1.5 for chat is different from the previous version. You can use the following code to chat with Qwen1.5:\nfrom transformers import AutoModelForCausalLM, AutoTokenizer device = \"cuda\" # the device to load the model onto model = AutoModelForCausalLM.from_pretrained( \"Qwen/Qwen1.5-14B-Chat-AWQ\", device_map=\"auto\" ) tokenizer = AutoTokenizer.from_pretrained(\"Qwen/Qwen1.5-14B-Chat-AWQ\") prompt = \"Give me a short introduction to large language model.\" messages = [ {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"}, {\"role\": \"user\", \"content\": prompt} ] text = tokenizer.apply_chat_template( messages, tokenize=False, add_generation_prompt=True ) model_inputs = tokenizer([text], return_tensors=\"pt\").to(device) generated_ids = model.generate( model_inputs.input_ids, max_new_tokens=512 ) generated_ids = [ output_ids[len(input_ids):] for input_ids, output_ids in zip(model_inputs.input_ids, generated_ids) ] response = tokenizer.batch_decode(generated_ids, skip_special_tokens=True)[0] For chat models, we no longer use a specific model.chat() method, but instead we use model.generate() with the chat template written in tokenizer_config.json so that we can use tokenizer.apply_chat_template() to generate the input, and we use eos_token to control when to stop the generation.\nWe also provide AWQ models and GPTQ models (including Int4 and Int8 models) for you to use Qwen1.5 in low-resource or deployment scenarios. As Huggingface transformers supports AWQ and GPTQ, you can use them in the same way above only with the corresponding model names.\nFurthermore, we have integrated our code to popular inference frameworks so that you can deploy your model easily. Now vLLM\u003e=0.3.0 and SGLang\u003e=0.1.11 officially support Qwen1.5. Check their official github repos and docs to learn about the detailed usage. Here we demonstrate an example to show how to use vLLM to build an OpenAI-API compatible interface for our model:\npython -m vllm.entrypoints.openai.api_server --model Qwen/Qwen1.5-7B-Chat curl http://localhost:8000/v1/chat/completions \\ -H \"Content-Type: application/json\" \\ -d '{ \"model\": \"Qwen/Qwen1.5-7B-Chat\", \"messages\": [ {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"}, {\"role\": \"user\", \"content\": \"Tell me something about large language models.\"} ] }' For users to run LLM locally, llama.cpp also provides support to Qwen1.5, and we officially provide quantized models in the GGUF format in our HF model hub. You can use the following code to run Qwen1.5 in llama.cpp:\n./main -m qwen1.5-7b-chat-q2_k.gguf -n 512 --color -i -cml -f prompts/chat-with-qwen.txt Besides, you can use the GGUF file with Ollama. Thanks to the support of Ollama, you can now directly use one line of command:\nollama run qwen Or you can use the GGUF file to play with llamafile to run our models with a single file.\nTo make a web demo locally, we advise you to use Text generation web UI which is very easy to use.\nFor advanced developers that hope to train better or more suitable models for themselves, such as post-training, Qwen1.5 is supported by Hugging face trainer and Peft. Also, there are easy-to-use frameworks that support both supervised finetuning (SFT) and alignment (PPO, DPO, etc.). Now, both LLaMA-Factory and Axolotl have supported the training of Qwen1.5. We advise you to turn to their official github repos and docs for more advanced usages.\nIf you would like to use Qwen1.5 for downstream applications, such as RAG, tool use, agent, you can now build OpenAI-API compatible API or run local models for famous frameworks, e.g., LlamaIndex, LangChain, CrewAI.\nOverall, as we care about your developing experience, we not only have tried our best to provide good models to the community but also have made efforts to make things easier for all of you. We hope that you can enjoy using Qwen1.5 and that it can help you with your tasks of either research or applications.\nConclusion We are excited to introduce Qwen1.5, the next version of our Qwen series. In this release, we have opensourced both base and chat models of 6 sizes, including 0.5B, 1.8B, 4B, 7B, 14B, and 72B, and we have also provided quantized models. We have merged our code of Qwen1.5 to Hugging face transformers, and you can directly use it with transformers\u003e=4.37.0 without trust_remote_code. Additionally, we have had frameworks, e.g., vLLM, SGLang, AutoGPTQ, etc., supported Qwen1.5. We believe from now on, using our models will be much easier. We believe that this release is though a small step towards model quality, but it is a big step towards developer experience. Hope you like it and enjoy using it. Join our Discord or WeChat to share your experience, comments, or whatever you like with us. We are looking forward to hearing from you.\nCitation @misc{qwen1.5, title = {Introducing Qwen1.5}, url = {https://qwenlm.github.io/blog/qwen1.5/}, author = {Qwen Team}, month = {February}, year = {2024} } ","wordCount":"2895","inLanguage":"en","datePublished":"2024-02-04T13:33:00+08:00","dateModified":"2024-02-04T13:33:00+08:00","author":{"@type":"Person","name":"Qwen Team"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://qwenlm.github.io/blog/qwen1.5/"},"publisher":{"@type":"Organization","name":"Qwen","logo":{"@type":"ImageObject","url":"https://qwenlm.github.io/favicon.png"}}}</script></head><body id=top><script>const hasHeaderBg=!1</script><header class=header><div class=nav-container><nav class=nav><div class=logo><a href=/ accesskey=h title="Qwen (Alt + H)"><img src=https://qwenlm.github.io/img/logo.png alt aria-label=logo height=30></a></div><ul id=menu><li><a href=/blog/ title=Blog><span>Blog</span></a></li><li><a href=/publication title=Publication><span>Publication</span></a></li><li><a href=/about title=About><span>About</span></a></li></ul></nav></div></header><div class=hero-container><div class=hero><h1 class=post-title>Introducing Qwen1.5</h1><div class=post-meta><span title='2024-02-04 13:33:00 +0800 +0800'>February 4, 2024</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;2895 words&nbsp;·&nbsp;Qwen Team&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://qwenlm.github.io/zh/blog/qwen1.5/>简体中文</a></li></ul></div></div></div><main class=main><article class=post-single><div class=post-content><p><a href=https://github.com/QwenLM/Qwen1.5 class="btn external" target=_blank>GITHUB</a>
<a href=https://huggingface.co/Qwen class="btn external" target=_blank>HUGGING FACE</a>
<a href=https://modelscope.cn/organization/qwen class="btn external" target=_blank>MODELSCOPE</a>
<a href=https://huggingface.co/spaces/Qwen/Qwen1.5-72B-Chat class="btn external" target=_blank>DEMO</a>
<a href=https://discord.gg/yPEP2vHTu4 class="btn external" target=_blank>DISCORD</a></p><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>In recent months, our focus has been on developing a &ldquo;good&rdquo; model while optimizing the developer experience. As we progress towards <strong>Qwen1.5</strong>, the next iteration in our Qwen series, this update arrives just before the Chinese New Year.</p><figure><img src=https://qianwen-res.oss-accelerate-overseas.aliyuncs.com/assets/blog/qwen1.5/intro.jpg#center width=80%></figure><p>With Qwen1.5, we are open-sourcing base and chat models across six sizes: 0.5B, 1.8B, 4B, 7B, 14B, 32B, 72B, and 110B, and also an MoE model (see <a href=https://qwenlm.github.io/blog/qwen-moe/>blog</a> for more information). In line with tradition, we&rsquo;re also providing quantized models, including Int4 and Int8 GPTQ models, as well as AWQ and GGUF quantized models. To enhance the developer experience, we&rsquo;ve merged Qwen1.5&rsquo;s code into Hugging Face transformers, making it accessible with <code>transformers>=4.37.0</code> without needing <code>trust_remote_code</code>.</p><p>We&rsquo;ve collaborated with frameworks like <a href=https://vllm.readthedocs.io/>vLLM</a>, <a href=https://github.com/sgl-project/sglang>SGLang</a> for deployment, <a href=https://github.com/casper-hansen/AutoAWQ>AutoAWQ</a>, <a href=https://github.com/AutoGPTQ/AutoGPTQ>AutoGPTQ</a> for quantization, <a href=https://github.com/OpenAccess-AI-Collective/axolotl>Axolotl</a>, <a href=https://github.com/hiyouga/LLaMA-Factory>LLaMA-Factory</a> for finetuning, and <a href=https://github.com/ggerganov/llama.cpp>llama.cpp</a> for local LLM inference, all of which now support Qwen1.5. The Qwen1.5 series is available on platforms such as <a href=https://ollama.ai/>Ollama</a> and <a href=https://lmstudio.ai/>LMStudio</a>. Additionally, API services are offered not only on DashScope but also on <a href=https://together.ai/>together.ai</a>, with global accessibility. Visit <a href=https://api.together.ai/>here</a> to get started, and we recommend trying out <a href=https://api.together.xyz/playground/chat/Qwen/Qwen1.5-72B-Chat>Qwen1.5-72B-chat</a>.</p><figure><img src=https://qianwen-res.oss-accelerate-overseas.aliyuncs.com/assets/blog/qwen1.5/com.jpg#center width=100%></figure><p>This release brings substantial improvements to the alignment of chat models with human preferences and enhanced multilingual capabilities. All models now uniformly support a context length of up to 32768 tokens. There have also been minor improvements in the quality of base language models that may benefit your finetuning endeavors. This step represents a small stride toward our objective of creating a truly &ldquo;good&rdquo; model.</p><h1 id=performance>Performance<a hidden class=anchor aria-hidden=true href=#performance>#</a></h1><p>To provide a better understanding of the performance of Qwen1.5, we have conducted a comprehensive evaluation of both base and chat models on different capabilities, including basic capabilities such as language understanding, coding, reasoning, multilingual capabilities, human preference, agent, retrieval-augmented generation (RAG), etc.</p><h2 id=basic-capabilities>Basic Capabilities<a hidden class=anchor aria-hidden=true href=#basic-capabilities>#</a></h2><p>To assess the basic capabilities of language models, we have conducted evaluations on traditional benchmarks, including MMLU (5-shot), C-Eval, Humaneval, GS8K, BBH, etc.</p><table><thead><tr><th style=text-align:left>Model</th><th style=text-align:center>MMLU</th><th style=text-align:center>C-Eval</th><th style=text-align:center>GSM8K</th><th style=text-align:center>MATH</th><th style=text-align:center>HumanEval</th><th style=text-align:center>MBPP</th><th style=text-align:center>BBH</th><th style=text-align:center>CMMLU</th></tr></thead><tbody><tr><td style=text-align:left>GPT-4</td><td style=text-align:center>86.4</td><td style=text-align:center>69.9</td><td style=text-align:center>92.0</td><td style=text-align:center>45.8</td><td style=text-align:center>67.0</td><td style=text-align:center>61.8</td><td style=text-align:center>86.7</td><td style=text-align:center>71.0</td></tr><tr><td style=text-align:left>Llama2-7B</td><td style=text-align:center>46.8</td><td style=text-align:center>32.5</td><td style=text-align:center>16.7</td><td style=text-align:center>3.3</td><td style=text-align:center>12.8</td><td style=text-align:center>20.8</td><td style=text-align:center>38.2</td><td style=text-align:center>31.8</td></tr><tr><td style=text-align:left>Llama2-13B</td><td style=text-align:center>55.0</td><td style=text-align:center>41.4</td><td style=text-align:center>29.6</td><td style=text-align:center>5.0</td><td style=text-align:center>18.9</td><td style=text-align:center>30.3</td><td style=text-align:center>45.6</td><td style=text-align:center>38.4</td></tr><tr><td style=text-align:left>Llama2-34B</td><td style=text-align:center>62.6</td><td style=text-align:center>-</td><td style=text-align:center>42.2</td><td style=text-align:center>6.2</td><td style=text-align:center>22.6</td><td style=text-align:center>33.0</td><td style=text-align:center>44.1</td><td style=text-align:center>-</td></tr><tr><td style=text-align:left>Llama2-70B</td><td style=text-align:center>69.8</td><td style=text-align:center>50.1</td><td style=text-align:center>54.4</td><td style=text-align:center>10.6</td><td style=text-align:center>23.7</td><td style=text-align:center>37.7</td><td style=text-align:center>58.4</td><td style=text-align:center>53.6</td></tr><tr><td style=text-align:left>Mistral-7B</td><td style=text-align:center>64.1</td><td style=text-align:center>47.4</td><td style=text-align:center>47.5</td><td style=text-align:center>11.3</td><td style=text-align:center>27.4</td><td style=text-align:center>38.6</td><td style=text-align:center>56.7</td><td style=text-align:center>44.7</td></tr><tr><td style=text-align:left>Mixtral-8x7B</td><td style=text-align:center>70.6</td><td style=text-align:center>-</td><td style=text-align:center>74.4</td><td style=text-align:center>28.4</td><td style=text-align:center>40.2</td><td style=text-align:center>60.7</td><td style=text-align:center>-</td><td style=text-align:center>-</td></tr><tr><td style=text-align:left>Qwen1.5-7B</td><td style=text-align:center>61.0</td><td style=text-align:center>74.1</td><td style=text-align:center>62.5</td><td style=text-align:center>20.3</td><td style=text-align:center>36.0</td><td style=text-align:center>37.4</td><td style=text-align:center>40.2</td><td style=text-align:center>73.1</td></tr><tr><td style=text-align:left>Qwen1.5-14B</td><td style=text-align:center>67.6</td><td style=text-align:center>78.7</td><td style=text-align:center>70.1</td><td style=text-align:center>29.2</td><td style=text-align:center>37.8</td><td style=text-align:center>44.0</td><td style=text-align:center>53.7</td><td style=text-align:center>77.6</td></tr><tr><td style=text-align:left>Qwen1.5-32B</td><td style=text-align:center>73.4</td><td style=text-align:center>83.5</td><td style=text-align:center>77.4</td><td style=text-align:center>36.1</td><td style=text-align:center>37.2</td><td style=text-align:center>49.4</td><td style=text-align:center>66.8</td><td style=text-align:center>82.3</td></tr><tr><td style=text-align:left>Qwen1.5-72B</td><td style=text-align:center>77.5</td><td style=text-align:center>84.1</td><td style=text-align:center>79.5</td><td style=text-align:center>34.1</td><td style=text-align:center>41.5</td><td style=text-align:center>53.4</td><td style=text-align:center>65.5</td><td style=text-align:center>83.5</td></tr></tbody></table><p>At every model size, Qwen1.5 demonstrates strong performance across the diverse evaluation benchmarks. In particular, Qwen1.5-72B outperforms Llama2-70B across all benchmarks, showcasing its exceptional capabilities in language understanding, reasoning, and math.</p><p>In light of the recent surge in interest for small language models, we have compared Qwen1.5 with sizes smaller than 7 billion parameters, against the most outstanding small-scale models within the community. The results are shown below:</p><table><thead><tr><th style=text-align:left>Model</th><th style=text-align:center>Non-Emb Params</th><th style=text-align:center>MMLU</th><th style=text-align:center>C-Eval</th><th style=text-align:center>GSM8K</th><th style=text-align:center>MATH</th><th style=text-align:center>HumanEval</th><th style=text-align:center>MBPP</th><th style=text-align:center>BBH</th><th style=text-align:center>CMMLU</th></tr></thead><tbody><tr><td style=text-align:left>Tinyllama-1.1B</td><td style=text-align:center>1.1B</td><td style=text-align:center>24.3</td><td style=text-align:center>25.0</td><td style=text-align:center>2.3</td><td style=text-align:center>0.7</td><td style=text-align:center>6.7</td><td style=text-align:center>19.9</td><td style=text-align:center>28.8</td><td style=text-align:center>24.0</td></tr><tr><td style=text-align:left>Gemini-Nano-3B</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>22.8</td><td style=text-align:center>-</td><td style=text-align:center>-</td><td style=text-align:center>27.2</td><td style=text-align:center>42.4</td><td style=text-align:center>-</td></tr><tr><td style=text-align:left>StableLM-Zephyr-3B</td><td style=text-align:center>2.7B</td><td style=text-align:center>45.9</td><td style=text-align:center>30.3</td><td style=text-align:center>52.5</td><td style=text-align:center>12.5</td><td style=text-align:center>35.4</td><td style=text-align:center>31.9</td><td style=text-align:center>37.7</td><td style=text-align:center>30.9</td></tr><tr><td style=text-align:left>Phi-2</td><td style=text-align:center>2.5B</td><td style=text-align:center>52.7</td><td style=text-align:center>23.4</td><td style=text-align:center>57.2</td><td style=text-align:center>3.5</td><td style=text-align:center>47.6</td><td style=text-align:center>55.0</td><td style=text-align:center>43.4</td><td style=text-align:center>24.2</td></tr><tr><td style=text-align:left>MiniCPM-2B</td><td style=text-align:center>2.4B</td><td style=text-align:center>53.5</td><td style=text-align:center>51.1</td><td style=text-align:center>53.8</td><td style=text-align:center>10.2</td><td style=text-align:center>50.0</td><td style=text-align:center>47.3</td><td style=text-align:center>36.9</td><td style=text-align:center>51.1</td></tr><tr><td style=text-align:left>Gemma-2B</td><td style=text-align:center>2.0B</td><td style=text-align:center>42.3</td><td style=text-align:center>-</td><td style=text-align:center>17.7</td><td style=text-align:center>11.8</td><td style=text-align:center>22.0</td><td style=text-align:center>29.2</td><td style=text-align:center>35.2</td><td style=text-align:center>-</td></tr><tr><td style=text-align:left>Qwen1.5-0.5B</td><td style=text-align:center>0.3B</td><td style=text-align:center>39.2</td><td style=text-align:center>50.5</td><td style=text-align:center>22.0</td><td style=text-align:center>3.1</td><td style=text-align:center>12.2</td><td style=text-align:center>6.8</td><td style=text-align:center>18.3</td><td style=text-align:center>46.6</td></tr><tr><td style=text-align:left>Qwen1.5-1.8B</td><td style=text-align:center>1.2B</td><td style=text-align:center>46.8</td><td style=text-align:center>59.7</td><td style=text-align:center>38.4</td><td style=text-align:center>10.1</td><td style=text-align:center>20.1</td><td style=text-align:center>18.0</td><td style=text-align:center>24.2</td><td style=text-align:center>57.8</td></tr><tr><td style=text-align:left>Qwen1.5-4B</td><td style=text-align:center>3.1B</td><td style=text-align:center>56.1</td><td style=text-align:center>67.6</td><td style=text-align:center>57.0</td><td style=text-align:center>10.0</td><td style=text-align:center>25.6</td><td style=text-align:center>29.2</td><td style=text-align:center>32.5</td><td style=text-align:center>66.7</td></tr><tr><td style=text-align:left>Qwen1.5-MoE-A2.7B</td><td style=text-align:center>2.0B</td><td style=text-align:center>62.5</td><td style=text-align:center>79.2</td><td style=text-align:center>61.5</td><td style=text-align:center>21.9</td><td style=text-align:center>34.2</td><td style=text-align:center>36.6</td><td style=text-align:center>39.1</td><td style=text-align:center>79.2</td></tr></tbody></table><p>We can confidently assert that Qwen1.5 base models under 7 billion parameters are highly competitive with the leading small-scale models in the community. In the future, we will continue to improve the quality of small models and exploring methods for effectively transferring the advanced capabilities inherent in larger models into the smaller ones.</p><h2 id=aligning-with-human-preference>Aligning with Human Preference<a hidden class=anchor aria-hidden=true href=#aligning-with-human-preference>#</a></h2><p>Alignment aims to enhance instruction-following capabilities of LLMs and help provide responses that are closely aligned with human preferences. Recognizing the significance of integrating human preferences into the learning process, we effectively employed techniques such as Direct Policy Optimization (DPO) and Proximal Policy Optimization (PPO) in aligning the latest Qwen series.</p><p>However, assessing the quality of such chat models poses a significant challenge.
Admittedly, while comprehensive human evaluation is the optimal approach, it faces significant challenges pertaining to scalability and reproducibility.
Therefore, we initially evaluate our models on two widely-used benchmarks, utilizing advanced LLMs as judges: MT-Bench and Alpaca-Eval. The results are presented below:</p><figure><img src=https://qianwen-res.oss-accelerate-overseas.aliyuncs.com/assets/blog/qwen1.5/sft.jpg#center width=80%></figure><p>We notice there are non-negligible variance in the scores on MT-Bench. So we have three runs with different seeds in our results and we report the average score with standard deviation.</p><table><tr><th rowspan=2 align=center>Models</th><th colspan=1 align=center>MT-Bench</th><th colspan=2 align=center>AlpacaEval 2.0</th></tr><tr><th align=center>Avg. Score</th><th align=center>Win Rate</th><th align=center>Length</th></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>8.61<sub>0.04</sub> (8.67/8.61/8.56)</td><td align=center>27.18<sub>1.30</sub></td><td align=center>1600</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>7.91<sub>0.11</sub> (7.99/7.99/7.77)</td><td align=center>19.7<sub>1.12</sub></td><td align=center>1608</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>7.60<sub>0.05</sub> (7.58/7.55/7.66)</td><td align=center>13.20<sub>1.43</sub></td><td align=center>1606</td></tr></table><p>Despite still significantly trailing behind GPT-4-Turbo, the largest open-source Qwen1.5 model, Qwen1.5-72B-Chat, exhibits superior performance, surpassing Claude-2.1, GPT-3.5-Turbo-0613, Mixtral-8x7b-instruct, and TULU 2 DPO 70B, being on par with Mistral Medium, on both MT-Bench and Alpaca-Eval v2.</p><p>Furthermore, although the scoring of LLM Judges may seemingly correlate with the lengths of responses, our observations indicate that our models do not generate lengthy responses to manipulate the bias of LLM judges. The average length of Qwen1.5-Chat on AlpacaEval 2.0 is only 1618, which aligns with the length of GPT-4 and is shorter than that of GPT-4-Turbo. Additionally, our experiments with our web service and app also reveal that users prefer the majority of responses from the new chat models.</p><h2 id=multilingual-understanding-of-base-models>Multilingual Understanding of Base Models<a hidden class=anchor aria-hidden=true href=#multilingual-understanding-of-base-models>#</a></h2><p>We have carefully selected a diverse set of 12 languages from Europe, East Asia, and Southeast Asia to thoroughly evaluate the multilingual capabilities of our foundational model. In order to accomplish this, we have curated test sets from the community&rsquo;s open-source repositories, covering four distinct dimensions: Exams, Understanding, Translation, and Math. The table below provides detailed information about each test set, including evaluation settings, metrics, and the languages they encompass:</p><table><thead><tr><th style=text-align:left>Dataset</th><th style=text-align:center>Category</th><th style=text-align:center>Method/Metric</th><th style=text-align:center>Languages</th></tr></thead><tbody><tr><td style=text-align:left>MMLU-multi</td><td style=text-align:center>Exams</td><td style=text-align:center>5-shot/Acc</td><td style=text-align:center>ar, es, fr, pt, de, it, ru, ja, ko, id</td></tr><tr><td style=text-align:left>M3Exams</td><td style=text-align:center>Exams</td><td style=text-align:center>5-shot/Acc</td><td style=text-align:center>pt, it, vi, th</td></tr><tr><td style=text-align:left>BELEBELE</td><td style=text-align:center>Understanding</td><td style=text-align:center>5-shot/Acc</td><td style=text-align:center>ar, es, fr, pt, de, it, ru, ja, ko, vi, th, id</td></tr><tr><td style=text-align:left>XWinograd</td><td style=text-align:center>Understanding</td><td style=text-align:center>5-shot/Acc</td><td style=text-align:center>fr, pt, ru, ja</td></tr><tr><td style=text-align:left>XCOPA</td><td style=text-align:center>Understanding</td><td style=text-align:center>5-shot/Acc</td><td style=text-align:center>vi, id, th</td></tr><tr><td style=text-align:left>PAWS-X</td><td style=text-align:center>Understanding</td><td style=text-align:center>5-shot/Acc</td><td style=text-align:center>es, fr, de, ja, ko</td></tr><tr><td style=text-align:left>XStoryCloze</td><td style=text-align:center>Understanding</td><td style=text-align:center>0-shot/Acc</td><td style=text-align:center>ar, es, ru, id</td></tr><tr><td style=text-align:left>Flores(zh/en↔xx)</td><td style=text-align:center>Translation</td><td style=text-align:center>5-shot/BLEU</td><td style=text-align:center>ar, es, fr, pt, de, it, ru, ja, ko, vi, th, id</td></tr><tr><td style=text-align:left>MGSM</td><td style=text-align:center>Math</td><td style=text-align:center>8-shot/Acc</td><td style=text-align:center>es, fr, ru, de, ja, th</td></tr></tbody></table><p>The detailed results are demonstrated below:</p><table><thead><tr><th style=text-align:left>Models</th><th style=text-align:center>Exams</th><th style=text-align:center>Understanding</th><th style=text-align:center>Math</th><th style=text-align:center>Translation</th></tr></thead><tbody><tr><td style=text-align:left>GPT-3.5</td><td style=text-align:center>52.24</td><td style=text-align:center>71.84</td><td style=text-align:center>32.80</td><td style=text-align:center>31.85</td></tr><tr><td style=text-align:left>GPT-4</td><td style=text-align:center>71.64</td><td style=text-align:center>83.82</td><td style=text-align:center>80.13</td><td style=text-align:center>34.37</td></tr><tr><td style=text-align:left>Llama2-7B</td><td style=text-align:center>34.03</td><td style=text-align:center>50.13</td><td style=text-align:center>9.40</td><td style=text-align:center>22.19</td></tr><tr><td style=text-align:left>Llama2-13B</td><td style=text-align:center>39.55</td><td style=text-align:center>57.26</td><td style=text-align:center>16.80</td><td style=text-align:center>25.89</td></tr><tr><td style=text-align:left>Llama2-70B</td><td style=text-align:center>55.88</td><td style=text-align:center>73.19</td><td style=text-align:center>40.20</td><td style=text-align:center>31.56</td></tr><tr><td style=text-align:left>Mistral-7B</td><td style=text-align:center>47.12</td><td style=text-align:center>63.30</td><td style=text-align:center>26.33</td><td style=text-align:center>23.33</td></tr><tr><td style=text-align:left>Mixtral-8x7B</td><td style=text-align:center>56.08</td><td style=text-align:center>70.70</td><td style=text-align:center>45.00</td><td style=text-align:center>29.78</td></tr><tr><td style=text-align:left>Qwen1.5-0.5B</td><td style=text-align:center>26.98</td><td style=text-align:center>44.08</td><td style=text-align:center>3.13</td><td style=text-align:center>9.17</td></tr><tr><td style=text-align:left>Qwen1.5-1.8B</td><td style=text-align:center>33.57</td><td style=text-align:center>48.37</td><td style=text-align:center>6.47</td><td style=text-align:center>16.19</td></tr><tr><td style=text-align:left>Qwen1.5-4B</td><td style=text-align:center>41.43</td><td style=text-align:center>59.76</td><td style=text-align:center>21.33</td><td style=text-align:center>23.34</td></tr><tr><td style=text-align:left>Qwen1.5-MoE-A2.7B</td><td style=text-align:center>44.54</td><td style=text-align:center>61.08</td><td style=text-align:center>30.20</td><td style=text-align:center>27.35</td></tr><tr><td style=text-align:left>Qwen1.5-7B</td><td style=text-align:center>47.70</td><td style=text-align:center>67.63</td><td style=text-align:center>37.27</td><td style=text-align:center>28.36</td></tr><tr><td style=text-align:left>Qwen1.5-14B</td><td style=text-align:center>55.72</td><td style=text-align:center>74.10</td><td style=text-align:center>49.93</td><td style=text-align:center>31.69</td></tr><tr><td style=text-align:left>Qwen1.5-72B</td><td style=text-align:center>66.35</td><td style=text-align:center>78.16</td><td style=text-align:center>61.67</td><td style=text-align:center>35.57</td></tr></tbody></table><p>The base models of Qwen1.5 showcase impressive multilingual capabilities, as demonstrated by its performance across a diverse set of 12 languages. In evaluations covering various dimensions such as exams, understanding, translation, and math, Qwen1.5 consistently delivers strong results. From languages like Arabic, Spanish, and French to Japanese, Korean, and Thai, Qwen1.5 demonstrates its ability to comprehend and generate high-quality content across different linguistic contexts.
We compared Qwen1.5-72B-Chat with GPT-3.5, and the results are shown below:</p><figure><img src=https://qianwen-res.oss-accelerate-overseas.aliyuncs.com/assets/blog/qwen1.5/lang.png#center width=100%></figure><p>These results demonstrate the strong multilingual capabilities of Qwen1.5 chat models, which can serve downstream applications, such as translation, language understanding, and multilingual chat. Also, we believe that the improvements in multilingual capabilities can also level up the general capabilities.</p><h2 id=support-of-long-context>Support of Long Context<a hidden class=anchor aria-hidden=true href=#support-of-long-context>#</a></h2><p>With the increasing demand for long-context understanding, we have expanded the capability of all models to support contexts up to 32K tokens. We have evaluated the performance of Qwen1.5 models on the <a href=https://github.com/OpenLMLab/LEval>L-Eval benchmark</a>, which measures the ability of models to generate responses based on long context. The results are shown below:</p><table><thead><tr><th style=text-align:left>Models</th><th style=text-align:center>Coursera</th><th style=text-align:center>GSM</th><th style=text-align:center>QuALITY</th><th style=text-align:center>TOEFL</th><th style=text-align:center>SFiction</th><th style=text-align:center>Avg.</th></tr></thead><tbody><tr><td style=text-align:left>GPT3.5-turbo-16k</td><td style=text-align:center>63.51</td><td style=text-align:center>84.00</td><td style=text-align:center>61.38</td><td style=text-align:center>78.43</td><td style=text-align:center>64.84</td><td style=text-align:center>70.43</td></tr><tr><td style=text-align:left>Claude1.3-100k</td><td style=text-align:center>60.03</td><td style=text-align:center>88.00</td><td style=text-align:center>73.76</td><td style=text-align:center>83.64</td><td style=text-align:center>72.65</td><td style=text-align:center>75.62</td></tr><tr><td style=text-align:left>GPT4-32k</td><td style=text-align:center>75.58</td><td style=text-align:center>96.00</td><td style=text-align:center>82.17</td><td style=text-align:center>84.38</td><td style=text-align:center>74.99</td><td style=text-align:center>82.62</td></tr><tr><td style=text-align:left>Qwen-72B-Chat</td><td style=text-align:center>58.13</td><td style=text-align:center>76.00</td><td style=text-align:center>77.22</td><td style=text-align:center>86.24</td><td style=text-align:center>69.53</td><td style=text-align:center>73.42</td></tr><tr><td style=text-align:left>Qwen1.5-0.5B-Chat</td><td style=text-align:center>30.81</td><td style=text-align:center>6.00</td><td style=text-align:center>34.16</td><td style=text-align:center>40.52</td><td style=text-align:center>49.22</td><td style=text-align:center>32.14</td></tr><tr><td style=text-align:left>Qwen1.5-1.8B-Chat</td><td style=text-align:center>39.24</td><td style=text-align:center>37.00</td><td style=text-align:center>42.08</td><td style=text-align:center>55.76</td><td style=text-align:center>44.53</td><td style=text-align:center>43.72</td></tr><tr><td style=text-align:left>Qwen1.5-4B-Chat</td><td style=text-align:center>54.94</td><td style=text-align:center>47.00</td><td style=text-align:center>57.92</td><td style=text-align:center>69.15</td><td style=text-align:center>56.25</td><td style=text-align:center>57.05</td></tr><tr><td style=text-align:left>Qwen1.5-7B-Chat</td><td style=text-align:center>59.74</td><td style=text-align:center>60.00</td><td style=text-align:center>64.36</td><td style=text-align:center>79.18</td><td style=text-align:center>62.50</td><td style=text-align:center>65.16</td></tr><tr><td style=text-align:left>Qwen1.5-14B-Chat</td><td style=text-align:center>69.04</td><td style=text-align:center>79.00</td><td style=text-align:center>74.75</td><td style=text-align:center>83.64</td><td style=text-align:center>75.78</td><td style=text-align:center>76.44</td></tr><tr><td style=text-align:left>Qwen1.5-72B-Chat</td><td style=text-align:center>71.95</td><td style=text-align:center>82.00</td><td style=text-align:center>77.72</td><td style=text-align:center>85.50</td><td style=text-align:center>73.44</td><td style=text-align:center>78.12</td></tr></tbody></table><p>In terms of the performance, even a small model like Qwen1.5-7B-Chat demonstrates competitive performance against GPT-3.5 on 4 out of 5 tasks. Our best model, Qwen1.5-72B-Chat, significantly outperforms GPT3.5-turbo-16k and only slightly falls behind GPT4-32k. These results highlight our outstanding performance within 32K tokens, yet they do not imply that our models are limited to supporting only 32K tokens. You can modify <code>max_position_embedding</code> and <code>sliding_window</code> in <code>config.json</code> to a larger value to see if the model performance is still satisfactory for your tasks.</p><h2 id=capabilities-to-connect-with-external-systems>Capabilities to Connect with External Systems<a hidden class=anchor aria-hidden=true href=#capabilities-to-connect-with-external-systems>#</a></h2><p>Large language models (LLMs) are popular in part due to their ability to integrate external knowledge and tools. Retrieval-Augmented Generation (RAG) has gained traction as it mitigates common LLM issues like hallucination, real-time data shortage, and private information handling. Additionally, strong LLMs typically excel at using APIs and tools via function calling, making them ideal for serving as AI agents.</p><p>We first assess the performance of Qwen1.5-Chat on <a href=https://arxiv.org/abs/2309.01431>RGB</a>, an RAG benchmark for which we have not performed any specific optimization:</p><table><tr><th colspan=5 align=center>RGB English Benchmark for Retrieval-Augmented Generation</th></tr><tr><th align=left>Models</th><th align=center>Noise 0.8 (Acc.↑)</th><th align=center>Rejection 1.0 (Acc.↑)</th><th align=center>Integration 0.4 (Acc.↑)</th><th align=center>Counterfactual (Acc.↑)</th></tr><tr><td>GPT4-Turbo</td><td align=center>85.67</td><td align=center>47.33</td><td align=center>60.00</td><td align=center>90.00</td></tr><tr><td>GPT3.5-Turbo</td><td align=center>74.33</td><td align=center>27.67</td><td align=center>47.00</td><td align=center>21.00</td></tr><tr><td>Llama2-70B-Chat</td><td align=center>82.00</td><td align=center>31.00</td><td align=center>56.00</td><td align=center>15.00</td></tr><tr><td>Mistral-7B-Instruct-v0.2</td><td align=center>82.00</td><td align=center>31.00</td><td align=center>56.00</td><td align=center>15.00</td></tr><tr><td>Mixtral-8x7B-Instruct-v0.1</td><td align=center>82.67</td><td align=center>37.00</td><td align=center>67.00</td><td align=center>8.00</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>77.67</td><td align=center>25.00</td><td align=center>52.00</td><td align=center>9.00</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>80.67</td><td align=center>24.00</td><td align=center>60.00</td><td align=center>8.00</td></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>81.67</td><td align=center>48.67</td><td align=center>61.00</td><td align=center>28.00</td></tr><tr><th colspan=5 align=center>RGB Chinese Benchmark for Retrieval-Augmented Generation</th></tr><tr><th align=center>Models</th><th align=center>Noise 0.8 (Acc.↑)</th><th align=center>Rejection 1.0 (Acc.↑)</th><th align=center>Integration 0.4 (Acc.↑)</th><th align=center>Counterfactual (Acc.↑)</th></tr><tr><td>GPT4-Turbo</td><td align=center>75.00</td><td align=center>38.67</td><td align=center>63.00</td><td align=center>90.00</td></tr><tr><td>GPT3.5-Turbo</td><td align=center>69.00</td><td align=center>13.00</td><td align=center>55.00</td><td align=center>25.00</td></tr><tr><td>Llama2-70B-Chat</td><td align=center>28.00</td><td align=center>17.00</td><td align=center>32.00</td><td align=center>8.00</td></tr><tr><td>Mistral-7B-Instruct-v0.2</td><td align=center>54.67</td><td align=center>28.67</td><td align=center>37.00</td><td align=center>4.00</td></tr><tr><td>Mixtral-8x7B-Instruct-v0.1</td><td align=center>27.33</td><td align=center>4.00</td><td align=center>24.00</td><td align=center>4.00</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>71.00</td><td align=center>10.33</td><td align=center>54.00</td><td align=center>20.00</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>75.00</td><td align=center>16.67</td><td align=center>55.00</td><td align=center>22.00</td></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>76.00</td><td align=center>51.00</td><td align=center>66.00</td><td align=center>44.00</td></tr></table><p>We then assess Qwen&rsquo;s capacity to function as a general-purpose agent by testing it on the <a href=https://open-compass.github.io/T-Eval/>T-Eval</a> benchmark. None of the Qwen models have undergone any optimization tailored specifically for this benchmark:</p><table><tr><th colspan=8 align=center>Agent Performance on T-Eval English</th></tr><tr><th align=left>Models</th><th align=center>Overall</th><th align=center>Instruct</th><th align=center>Plan</th><th align=center>Reason</th><th align=center>Retrieve</th><th align=center>Understand</th><th align=center>Review</th></tr><tr><td>GPT4-Turbo</td><td align=center>86.4</td><td align=center>96.3</td><td align=center>87.8</td><td align=center>65.3</td><td align=center>88.9</td><td align=center>85.8</td><td align=center>94.5</td></tr><tr><td>Llama-2-70B-Chat</td><td align=center>58.59</td><td align=center>77.80</td><td align=center>63.75</td><td align=center>39.07</td><td align=center>51.35</td><td align=center>50.34</td><td align=center>69.20</td></tr><tr><td>Mistral-7B-Instruct-v0.2</td><td align=center>46.68</td><td align=center>63.57</td><td align=center>60.88</td><td align=center>32.59</td><td align=center>17.58</td><td align=center>38.08</td><td align=center>67.35</td></tr><tr><td>Mixtral-8x7B-Instruct-v0.1</td><td align=center>62.15</td><td align=center>42.39</td><td align=center>46.48</td><td align=center>60.35</td><td align=center>76.69</td><td align=center>73.70</td><td align=center>73.31</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>59.67</td><td align=center>71.12</td><td align=center>62.95</td><td align=center>37.60</td><td align=center>61.17</td><td align=center>53.75</td><td align=center>71.46</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>71.77</td><td align=center>86.16</td><td align=center>73.09</td><td align=center>49.51</td><td align=center>72.07</td><td align=center>66.03</td><td align=center>83.78</td></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>76.69</td><td align=center>80.96</td><td align=center>83.12</td><td align=center>56.89</td><td align=center>80.17</td><td align=center>76.68</td><td align=center>82.34</td></tr><tr><th colspan=8 align=center>Agent Performance on T-Eval Chinese</th></tr><tr><th align=center>Models</th><th align=center>Overall</th><th align=center>Instruct</th><th align=center>Plan</th><th align=center>Reason</th><th align=center>Retrieve</th><th align=center>Understand</th><th align=center>Review</th></tr><tr><td>GPT4-Turbo</td><td align=center>85.9</td><td align=center>97.6</td><td align=center>87.0</td><td align=center>68.4</td><td align=center>89.2</td><td align=center>86.8</td><td align=center>86.0</td></tr><tr><td>Llama-2-70B-Chat</td><td align=center>51.15</td><td align=center>53.78</td><td align=center>56.65</td><td align=center>34.27</td><td align=center>48.24</td><td align=center>50.49</td><td align=center>63.45</td></tr><tr><td>Mistral-7B-Instruct-v0.2</td><td align=center>46.26</td><td align=center>49.64</td><td align=center>61.82</td><td align=center>36.17</td><td align=center>20.26</td><td align=center>47.25</td><td align=center>62.42</td></tr><tr><td>Mixtral-8x7B-Instruct-v0.1</td><td align=center>62.77</td><td align=center>26.38</td><td align=center>60.79</td><td align=center>62.02</td><td align=center>76.60</td><td align=center>77.74</td><td align=center>73.10</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>53.15</td><td align=center>60.56</td><td align=center>62.31</td><td align=center>42.07</td><td align=center>55.28</td><td align=center>55.76</td><td align=center>42.92</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>64.85</td><td align=center>84.25</td><td align=center>64.77</td><td align=center>54.68</td><td align=center>72.35</td><td align=center>68.88</td><td align=center>44.15</td></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>72.88</td><td align=center>97.50</td><td align=center>80.83</td><td align=center>58.11</td><td align=center>76.14</td><td align=center>71.94</td><td align=center>52.77</td></tr></table><p>To test the capabilities of tool using, also known as function calling, we follow our previous practice and use our opensourced evaluation <a href=https://github.com/QwenLM/Qwen/blob/main/eval/evaluate_plugin.py>benchmark</a> for assessing the models&rsquo; ability to appropriately select and use tools:</p><table><tr><th colspan=4 align=center>Tool-Use Benchmark</th></tr><tr><th align=left>Models</th><th align=center>Tool Selection (Acc.↑)</th><th align=center>Tool Input (Rouge-L↑)</th><th align=center>False Positive (Acc.↑)</th></tr><tr><td>GPT-4</td><td align=center>98.0</td><td align=center>95.3</td><td align=center>76.1</td></tr><tr><td>GPT-3.5</td><td align=center>74.5</td><td align=center>80.7</td><td align=center>19.4</td></tr><tr><td>Llama-2-70B-Chat</td><td align=center>88.54</td><td align=center>70.36</td><td align=center>0.37</td></tr><tr><td>Mistral-7B-Instruct-v0.2</td><td align=center>94.79</td><td align=center>82.81</td><td align=center>6.34</td></tr><tr><td>Mixtral-8x7B-Instruct-v0.1</td><td align=center>99.31</td><td align=center>94.46</td><td align=center>31.34</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>95.83</td><td align=center>89.48</td><td align=center>92.54</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>93.06</td><td align=center>88.74</td><td align=center>92.91</td></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>95.14</td><td align=center>91.14</td><td align=center>98.51</td></tr></table><p>Finally, since the Python code interpreter has emerged as an increasingly powerful tool for advanced LLMs, we also evaluate our models&rsquo; capability in utilizing this tool on our previously open-sourced <a href=https://github.com/QwenLM/Qwen-Agent/tree/main/benchmark>benchmark</a>:</p><table><tr><th colspan=5 align=left>Code Interpreter Benchmark</th></tr><tr><th rowspan=2 align=center>Models</th><th colspan=3 align=center>Accuracy of Code Execution Results (%)</th><th colspan=1 align=center>Executable Rate of Code (%)</th></tr><tr><th align=center>Math↑</th><th align=center>Visualization-Hard↑</th><th align=center>Visualization-Easy↑</th><th align=center>General↑</th></tr><tr><td>GPT-4</td><td align=center>82.8</td><td align=center>66.7</td><td align=center>60.8</td><td align=center>82.8</td></tr><tr><td>GPT-3.5</td><td align=center>47.3</td><td align=center>33.3</td><td align=center>55.7</td><td align=center>74.1</td></tr><tr><td>Mistral-7B-Instruct-v0.2</td><td align=center>25.5</td><td align=center>19.1</td><td align=center>44.3</td><td align=center>62.1</td></tr><tr><td>Mixtral-8x7B-Instruct-v0.1</td><td align=center>47.8</td><td align=center>33.3</td><td align=center>54.4</td><td align=center>60.3</td></tr><tr><td>Qwen1.5-7B-Chat</td><td align=center>54.0</td><td align=center>35.7</td><td align=center>36.7</td><td align=center>65.5</td></tr><tr><td>Qwen1.5-14B-Chat</td><td align=center>62.1</td><td align=center>46.4</td><td align=center>48.1</td><td align=center>70.6</td></tr><tr><td>Qwen1.5-72B-Chat</td><td align=center>73.1</td><td align=center>52.3</td><td align=center>50.6</td><td align=center>87.9</td></tr></table><p>Larger Qwen1.5-Chat models generally outperform smaller ones, nearing GPT-4&rsquo;s tool-use performance. However, in code interpreter tasks like math problem-solving and visualization, even the largest Qwen1.5-72B-Chat model lags significantly behind GPT-4 due to coding capabilities. We aim in future versions to enhance the coding capabilities of all Qwen models during both pre-training and alignment.</p><h1 id=develop-with-qwen15>Develop with Qwen1.5<a hidden class=anchor aria-hidden=true href=#develop-with-qwen15>#</a></h1><p>The biggest difference in Qwen1.5 is the integration of Qwen1.5 to Hugging Face transformers. Since 4.37.0, you can use Qwen1.5 without our custom code, which means that you can load the model like the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoModelForCausalLM</span>
</span></span><span class=line><span class=cl><span class=c1># This is what we previously used</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>AutoModelForCausalLM</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=s2>&#34;Qwen/Qwen-7B-Chat&#34;</span><span class=p>,</span> <span class=n>device_map</span><span class=o>=</span><span class=s2>&#34;auto&#34;</span><span class=p>,</span> <span class=n>trust_remote_code</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># This is what you can use now</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>AutoModelForCausalLM</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=s2>&#34;Qwen/Qwen1.5-7B-Chat&#34;</span><span class=p>,</span> <span class=n>device_map</span><span class=o>=</span><span class=s2>&#34;auto&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>The usage of Qwen1.5 for chat is different from the previous version. You can use the following code to chat with Qwen1.5:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoModelForCausalLM</span><span class=p>,</span> <span class=n>AutoTokenizer</span>
</span></span><span class=line><span class=cl><span class=n>device</span> <span class=o>=</span> <span class=s2>&#34;cuda&#34;</span> <span class=c1># the device to load the model onto</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>AutoModelForCausalLM</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Qwen/Qwen1.5-14B-Chat-AWQ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>device_map</span><span class=o>=</span><span class=s2>&#34;auto&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tokenizer</span> <span class=o>=</span> <span class=n>AutoTokenizer</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=s2>&#34;Qwen/Qwen1.5-14B-Chat-AWQ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prompt</span> <span class=o>=</span> <span class=s2>&#34;Give me a short introduction to large language model.&#34;</span>
</span></span><span class=line><span class=cl><span class=n>messages</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;You are a helpful assistant.&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>prompt</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>text</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>apply_chat_template</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>messages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tokenize</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>add_generation_prompt</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model_inputs</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=p>([</span><span class=n>text</span><span class=p>],</span> <span class=n>return_tensors</span><span class=o>=</span><span class=s2>&#34;pt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>generated_ids</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>model_inputs</span><span class=o>.</span><span class=n>input_ids</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>max_new_tokens</span><span class=o>=</span><span class=mi>512</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>generated_ids</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>output_ids</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>input_ids</span><span class=p>):]</span> <span class=k>for</span> <span class=n>input_ids</span><span class=p>,</span> <span class=n>output_ids</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>model_inputs</span><span class=o>.</span><span class=n>input_ids</span><span class=p>,</span> <span class=n>generated_ids</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>batch_decode</span><span class=p>(</span><span class=n>generated_ids</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span></code></pre></div><p>For chat models, we no longer use a specific <code>model.chat()</code> method, but instead we use <code>model.generate()</code> with the chat template written in <code>tokenizer_config.json</code> so that we can use <code>tokenizer.apply_chat_template()</code> to generate the input, and we use <code>eos_token</code> to control when to stop the generation.</p><p>We also provide AWQ models and GPTQ models (including Int4 and Int8 models) for you to use Qwen1.5 in low-resource or deployment scenarios. As Huggingface transformers supports <a href=https://github.com/casper-hansen/AutoAWQ>AWQ</a> and <a href=https://github.com/AutoGPTQ/AutoGPTQ>GPTQ</a>, you can use them in the same way above only with the corresponding model names.</p><p>Furthermore, we have integrated our code to popular inference frameworks so that you can deploy your model easily. Now <code>vLLM>=0.3.0</code> and <code>SGLang>=0.1.11</code> officially support Qwen1.5. Check their official github repos and docs to learn about the detailed usage. Here we demonstrate an example to show how to use vLLM to build an OpenAI-API compatible interface for our model:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python -m vllm.entrypoints.openai.api_server --model Qwen/Qwen1.5-7B-Chat
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl http://localhost:8000/v1/chat/completions <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -H <span class=s2>&#34;Content-Type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -d <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;model&#34;: &#34;Qwen/Qwen1.5-7B-Chat&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;messages&#34;: [
</span></span></span><span class=line><span class=cl><span class=s1>    {&#34;role&#34;: &#34;system&#34;, &#34;content&#34;: &#34;You are a helpful assistant.&#34;},
</span></span></span><span class=line><span class=cl><span class=s1>    {&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Tell me something about large language models.&#34;}
</span></span></span><span class=line><span class=cl><span class=s1>    ]
</span></span></span><span class=line><span class=cl><span class=s1>    }&#39;</span>
</span></span></code></pre></div><p>For users to run LLM locally, llama.cpp also provides support to Qwen1.5, and we officially provide quantized models in the GGUF format in our HF model hub. You can use the following code to run Qwen1.5 in llama.cpp:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>./main -m qwen1.5-7b-chat-q2_k.gguf -n <span class=m>512</span> --color -i -cml -f prompts/chat-with-qwen.txt
</span></span></code></pre></div><p>Besides, you can use the GGUF file with Ollama. Thanks to the support of <a href=https://ollama.ai/>Ollama</a>, you can now directly use one line of command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ollama run qwen
</span></span></code></pre></div><p>Or you can use the GGUF file to play with <a href=https://github.com/Mozilla-Ocho/llamafile>llamafile</a> to run our models with a single file.</p><p>To make a web demo locally, we advise you to use <a href=https://github.com/oobabooga/text-generation-webui>Text generation web UI</a> which is very easy to use.</p><p>For advanced developers that hope to train better or more suitable models for themselves, such as post-training, Qwen1.5 is supported by Hugging face <code>trainer</code> and Peft. Also, there are easy-to-use frameworks that support both supervised finetuning (SFT) and alignment (PPO, DPO, etc.). Now, both <a href=https://github.com/hiyouga/LLaMA-Factory>LLaMA-Factory</a> and <a href=https://github.com/OpenAccess-AI-Collective/axolotl>Axolotl</a> have supported the training of Qwen1.5. We advise you to turn to their official github repos and docs for more advanced usages.</p><p>If you would like to use Qwen1.5 for downstream applications, such as RAG, tool use, agent, you can now build OpenAI-API compatible API or run local models for famous frameworks, e.g., <a href=https://www.llamaindex.ai/>LlamaIndex</a>, <a href=https://www.langchain.com/>LangChain</a>, <a href=https://www.crewai.io/>CrewAI</a>.</p><p>Overall, as we care about your developing experience, we not only have tried our best to provide good models to the community but also have made efforts to make things easier for all of you. We hope that you can enjoy using Qwen1.5 and that it can help you with your tasks of either research or applications.</p><h1 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h1><p>We are excited to introduce Qwen1.5, the next version of our Qwen series. In this release, we have opensourced both base and chat models of 6 sizes, including 0.5B, 1.8B, 4B, 7B, 14B, and 72B, and we have also provided quantized models. We have merged our code of Qwen1.5 to Hugging face transformers, and you can directly use it with <code>transformers>=4.37.0</code> without <code>trust_remote_code</code>. Additionally, we have had frameworks, e.g., vLLM, SGLang, AutoGPTQ, etc., supported Qwen1.5. We believe from now on, using our models will be much easier. We believe that this release is though a small step towards model quality, but it is a big step towards developer experience. Hope you like it and enjoy using it. Join our <a href=https://discord.gg/yPEP2vHTu4>Discord</a> or <a href=https://github.com/QwenLM/Qwen/blob/main/assets/wechat.png>WeChat</a> to share your experience, comments, or whatever you like with us. We are looking forward to hearing from you.</p><h1 id=citation>Citation<a hidden class=anchor aria-hidden=true href=#citation>#</a></h1><pre tabindex=0><code>@misc{qwen1.5,
    title = {Introducing Qwen1.5},
    url = {https://qwenlm.github.io/blog/qwen1.5/},
    author = {Qwen Team},
    month = {February},
    year = {2024}
}
</code></pre></div></article></main><footer class=footer><span>&copy; 2024 <a href=https://qwenlm.github.io/>Qwen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 8" fill="currentcolor"><path d="M12 8H0l6-8z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")},mybutton.oncontextmenu=e=>{e.preventDefault(),document.querySelectorAll(".example-container").forEach(e=>{e.style.backgroundColor="unset"}),document.querySelectorAll(".example-content").forEach(e=>{e.style.display="block",e.style.backgroundColor="var(--code-bg)",e.style.marginBottom="var(--modal-gap)"}),document.querySelectorAll(".next-button").forEach(e=>{e.style.display="none"})}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>